#pragma once
#include <array>
#include <iostream>
#include <chrono>
#include <vector>
#include "container.h"
#include "stepper.h"

inline void test_stepper() {
    std::cout << "\n=================== START TEST STEPPER ===================\n";
    auto t1 = std::chrono::high_resolution_clock::now();

    constexpr double r = 0.14;
    constexpr double d = 0.20;
    constexpr double sigma = 0.16;
    constexpr double kappa = 0.10;
    constexpr double beta = 1.0;
    constexpr double epsilon = 0.13;
    constexpr double rho = 0.50;
    constexpr double theta = 0.30;

    constexpr size_t n = 20;
    constexpr size_t m = 20;
    constexpr size_t p = 365;
    constexpr double T = 1.0;
    constexpr double M = 1.0;
    constexpr double S_0 = 100.0;
    constexpr double V_0 = 1.0;
    constexpr double K = 90;

    const auto sp = SystemParams(
        r, d, sigma, kappa, beta, epsilon, rho, theta, S_0, V_0, T, M, K, n, m, p
    );

    std::vector<std::array<double, (n + 1) * (m + 1)>> results;

    {
        Matrix2D<(n + 1) * (m + 1)> A;
        std::array<double, (n + 1) * (m + 1)> res = {};
        option_price_stepper<Matrix2D<(n + 1) * (m + 1)>, m, n>(
            sp, A, res
        );

        results.push_back(res);
    }

    {
        Matrix1D<(n + 1) * (m + 1)> A;
        std::array<double, (n + 1) * (m + 1)> res = {};
        option_price_stepper<Matrix1D<(n + 1) * (m + 1)>,  m, n>(
            sp, A, res
        );

        results.push_back(res);
    }


    {
        MatrixGSL<(n + 1) * (m + 1)> A;
        std::array<double, (n + 1) * (m + 1)> res = {};
        option_price_stepper<
            MatrixGSL<(n + 1) * (m + 1)>, m, n>(sp, A, res);

        results.push_back(res);
    }

    std::cout << "    (V_i, S_j)    == Matrix2D == Matrix1D == MatrixGSL \n";

    for (int i = 0; i < m + 1; i++) {
        for (int j = 0; j < n + 1; j++) {
            std::cout << "(" << sp.m_V_max * i / m << ", " << sp.m_S_max * j / n
                      << ")   ";
            for (int l = 0; l < results.size(); l++) {
                std::cout << results[l][i * (n + 1) + j] << "  | ";
            }
            std::cout << "\n";
        }
    }
    auto t2 = std::chrono::high_resolution_clock::now();
    auto ms_int = std::chrono::duration_cast<std::chrono::milliseconds>(t2 - t1);
    std::cout << static_cast<double>(ms_int.count()) / 1e3 << " seconds\n";
    std::cout << "=================== END TEST STEPPER ===================\n";
}

/*
=================== START TEST CONTAINER ===================
TEST: METHODS & COPY CTOR
PASSED

=================== END TEST CONTAINER ===================

=================== START TEST UTILS ===================
TEST: ADJUST BOUNDARY
i          : 177
j          : 170
S_max      : 117.64706
S_0 * n / j: 117.64706
V_max      :   1.12994
V_0 * m / i:   1.12994
PASSED

==================== END TEST SLAE ====================


=================== START TEST SLAE ===================
TEST 1: Matrix2D GE
x1 = 1.00000, ans1 = 1.00000
x2 = 2.00000, ans2 = 2.00000
x3 = 3.00000, ans3 = 3.00000
PASSED

TEST 2: Matrix1D GE
x1 = 1.00000, ans1 = 1.00000
x2 = 0.00000, ans2 = 0.00000
x3 = 2.00000, ans3 = 2.00000
PASSED

TEST 3: Matrix1D GE
x1 = -0.12946, ans1 = -0.12946
x2 = 2.14732, ans2 = 2.14732
x3 = -0.29464, ans3 = -0.29464
x4 = 0.14732, ans4 = 0.14732
PASSED

TEST 4: Matrix1D GE
x1 = 0.11255, ans1 = 0.11255
x2 = -1.12983, ans2 = -1.12983
x3 = 1.04904, ans3 = 1.04904
x4 = -1.40540, ans4 = -1.40540
x5 = 1.98550, ans5 = 1.98550
x6 = 0.45166, ans6 = 0.45166
PASSED

TEST 5: MatrixGSL GE
x1 = 0.11255, ans1 = 0.11255
x2 = -1.12983, ans2 = -1.12983
x3 = 1.04904, ans3 = 1.04904
x4 = -1.40540, ans4 = -1.40540
x5 = 1.98550, ans5 = 1.98550
x6 = 0.45166, ans6 = 0.45166
PASSED

==================== END TEST SLAE ====================


=================== START TEST STEPPER ===================
    (V_i, S_j)    == Matrix2D == Matrix1D == MatrixGSL
(0.00000, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 5.88235)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 11.76471)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 17.64706)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 23.52941)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 29.41176)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 35.29412)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 41.17647)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 47.05882)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 52.94118)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 58.82353)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 64.70588)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 70.58824)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 76.47059)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 82.35294)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 88.23529)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 94.11765)   0.00000  | 0.00000  | 0.00000  |
(0.00000, 100.00000)   3.66056  | 3.66056  | 3.66056  |
(0.00000, 105.88235)   8.48191  | 8.48191  | 8.48191  |
(0.00000, 111.76471)   13.30325  | 13.30325  | 13.30325  |
(0.00000, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.05556, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.05556, 5.88235)   0.00000  | 0.00000  | -0.00000  |
(0.05556, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(0.05556, 17.64706)   0.00000  | 0.00000  | -0.00000  |
(0.05556, 23.52941)   0.00000  | 0.00000  | -0.00000  |
(0.05556, 29.41176)   0.00000  | 0.00000  | 0.00000  |
(0.05556, 35.29412)   0.00002  | 0.00002  | 0.00002  |
(0.05556, 41.17647)   0.00021  | 0.00021  | 0.00028  |
(0.05556, 47.05882)   0.00201  | 0.00201  | 0.00289  |
(0.05556, 52.94118)   0.01367  | 0.01367  | 0.02029  |
(0.05556, 58.82353)   0.06934  | 0.06934  | 0.10345  |
(0.05556, 64.70588)   0.26834  | 0.26834  | 0.39226  |
(0.05556, 70.58824)   0.81148  | 0.81148  | 1.12815  |
(0.05556, 76.47059)   1.96716  | 1.96716  | 2.51379  |
(0.05556, 82.35294)   3.92871  | 3.92871  | 4.46731  |
(0.05556, 88.23529)   6.64979  | 6.64979  | 6.60427  |
(0.05556, 94.11765)   9.80037  | 9.80037  | 8.58619  |
(0.05556, 100.00000)   12.91421  | 12.91421  | 10.45241  |
(0.05556, 105.88235)   15.56340  | 15.56340  | 12.51445  |
(0.05556, 111.76471)   17.37149  | 17.37149  | 15.00814  |
(0.05556, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.11111, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.11111, 5.88235)   0.00000  | 0.00000  | -0.00000  |
(0.11111, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(0.11111, 17.64706)   0.00000  | 0.00000  | -0.00000  |
(0.11111, 23.52941)   0.00000  | 0.00000  | -0.00000  |
(0.11111, 29.41176)   0.00000  | 0.00000  | -0.00001  |
(0.11111, 35.29412)   0.00001  | 0.00001  | -0.00002  |
(0.11111, 41.17647)   0.00018  | 0.00018  | 0.00016  |
(0.11111, 47.05882)   0.00173  | 0.00173  | 0.00278  |
(0.11111, 52.94118)   0.01202  | 0.01202  | 0.02104  |
(0.11111, 58.82353)   0.06198  | 0.06198  | 0.10570  |
(0.11111, 64.70588)   0.24349  | 0.24349  | 0.38742  |
(0.11111, 70.58824)   0.74678  | 0.74678  | 1.07865  |
(0.11111, 76.47059)   1.83488  | 1.83488  | 2.34540  |
(0.11111, 82.35294)   3.71336  | 3.71336  | 4.11041  |
(0.11111, 88.23529)   6.37080  | 6.37080  | 6.06721  |
(0.11111, 94.11765)   9.52607  | 9.52607  | 7.98254  |
(0.11111, 100.00000)   12.71849  | 12.71849  | 9.91205  |
(0.11111, 105.88235)   15.45680  | 15.45680  | 12.09299  |
(0.11111, 111.76471)   17.34033  | 17.34033  | 14.76231  |
(0.11111, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.16667, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.16667, 5.88235)   0.00000  | 0.00000  | -0.00000  |
(0.16667, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(0.16667, 17.64706)   0.00000  | 0.00000  | -0.00000  |
(0.16667, 23.52941)   0.00000  | 0.00000  | -0.00000  |
(0.16667, 29.41176)   0.00000  | 0.00000  | -0.00000  |
(0.16667, 35.29412)   0.00001  | 0.00001  | 0.00004  |
(0.16667, 41.17647)   0.00018  | 0.00018  | 0.00063  |
(0.16667, 47.05882)   0.00174  | 0.00174  | 0.00525  |
(0.16667, 52.94118)   0.01206  | 0.01206  | 0.03000  |
(0.16667, 58.82353)   0.06204  | 0.06204  | 0.12798  |
(0.16667, 64.70588)   0.24342  | 0.24342  | 0.42173  |
(0.16667, 70.58824)   0.74597  | 0.74597  | 1.09338  |
(0.16667, 76.47059)   1.83212  | 1.83212  | 2.26843  |
(0.16667, 82.35294)   3.70731  | 3.70731  | 3.86613  |
(0.16667, 88.23529)   6.36110  | 6.36110  | 5.64293  |
(0.16667, 94.11765)   9.51439  | 9.51439  | 7.45089  |
(0.16667, 100.00000)   12.70780  | 12.70780  | 9.38617  |
(0.16667, 105.88235)   15.44918  | 15.44918  | 11.67388  |
(0.16667, 111.76471)   17.33660  | 17.33660  | 14.52391  |
(0.16667, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.22222, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.22222, 5.88235)   0.00000  | 0.00000  | -0.00000  |
(0.22222, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(0.22222, 17.64706)   0.00000  | 0.00000  | -0.00000  |
(0.22222, 23.52941)   0.00000  | 0.00000  | -0.00000  |
(0.22222, 29.41176)   0.00000  | 0.00000  | 0.00001  |
(0.22222, 35.29412)   0.00001  | 0.00001  | 0.00011  |
(0.22222, 41.17647)   0.00018  | 0.00018  | 0.00108  |
(0.22222, 47.05882)   0.00174  | 0.00174  | 0.00731  |
(0.22222, 52.94118)   0.01206  | 0.01206  | 0.03660  |
(0.22222, 58.82353)   0.06205  | 0.06205  | 0.14208  |
(0.22222, 64.70588)   0.24343  | 0.24343  | 0.43698  |
(0.22222, 70.58824)   0.74596  | 0.74596  | 1.07777  |
(0.22222, 76.47059)   1.83201  | 1.83201  | 2.16090  |
(0.22222, 82.35294)   3.70700  | 3.70700  | 3.61012  |
(0.22222, 88.23529)   6.36051  | 6.36051  | 5.23737  |
(0.22222, 94.11765)   9.51359  | 9.51359  | 6.96181  |
(0.22222, 100.00000)   12.70696  | 12.70696  | 8.90811  |
(0.22222, 105.88235)   15.44850  | 15.44850  | 11.29123  |
(0.22222, 111.76471)   17.33621  | 17.33621  | 14.30330  |
(0.22222, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.27778, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.27778, 5.88235)   0.00000  | 0.00000  | -0.00000  |
(0.27778, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(0.27778, 17.64706)   0.00000  | 0.00000  | -0.00000  |
(0.27778, 23.52941)   0.00000  | 0.00000  | 0.00000  |
(0.27778, 29.41176)   0.00000  | 0.00000  | 0.00001  |
(0.27778, 35.29412)   0.00001  | 0.00001  | 0.00017  |
(0.27778, 41.17647)   0.00018  | 0.00018  | 0.00145  |
(0.27778, 47.05882)   0.00174  | 0.00174  | 0.00885  |
(0.27778, 52.94118)   0.01206  | 0.01206  | 0.04098  |
(0.27778, 58.82353)   0.06205  | 0.06205  | 0.14961  |
(0.27778, 64.70588)   0.24343  | 0.24343  | 0.43862  |
(0.27778, 70.58824)   0.74596  | 0.74596  | 1.04313  |
(0.27778, 76.47059)   1.83201  | 1.83201  | 2.03867  |
(0.27778, 82.35294)   3.70698  | 3.70698  | 3.35760  |
(0.27778, 88.23529)   6.36047  | 6.36047  | 4.85973  |
(0.27778, 94.11765)   9.51352  | 9.51352  | 6.51715  |
(0.27778, 100.00000)   12.70688  | 12.70688  | 8.47514  |
(0.27778, 105.88235)   15.44843  | 15.44843  | 10.94141  |
(0.27778, 111.76471)   17.33617  | 17.33617  | 14.09828  |
(0.27778, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.33333, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.33333, 5.88235)   0.00000  | 0.00000  | -0.00000  |
(0.33333, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(0.33333, 17.64706)   0.00000  | 0.00000  | -0.00000  |
(0.33333, 23.52941)   0.00000  | 0.00000  | 0.00000  |
(0.33333, 29.41176)   0.00000  | 0.00000  | 0.00002  |
(0.33333, 35.29412)   0.00001  | 0.00001  | 0.00022  |
(0.33333, 41.17647)   0.00018  | 0.00018  | 0.00175  |
(0.33333, 47.05882)   0.00174  | 0.00174  | 0.00994  |
(0.33333, 52.94118)   0.01206  | 0.01206  | 0.04362  |
(0.33333, 58.82353)   0.06205  | 0.06205  | 0.15250  |
(0.33333, 64.70588)   0.24343  | 0.24343  | 0.43150  |
(0.33333, 70.58824)   0.74596  | 0.74596  | 0.99790  |
(0.33333, 76.47059)   1.83201  | 1.83201  | 1.91210  |
(0.33333, 82.35294)   3.70697  | 3.70697  | 3.11702  |
(0.33333, 88.23529)   6.36046  | 6.36046  | 4.51350  |
(0.33333, 94.11765)   9.51351  | 9.51351  | 6.11546  |
(0.33333, 100.00000)   12.70687  | 12.70687  | 8.08346  |
(0.33333, 105.88235)   15.44842  | 15.44842  | 10.62096  |
(0.33333, 111.76471)   17.33617  | 17.33617  | 13.90705  |
(0.33333, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.38889, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.38889, 5.88235)   0.00000  | 0.00000  | -0.00000  |
(0.38889, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(0.38889, 17.64706)   0.00000  | 0.00000  | 0.00000  |
(0.38889, 23.52941)   0.00000  | 0.00000  | 0.00000  |
(0.38889, 29.41176)   0.00000  | 0.00000  | 0.00002  |
(0.38889, 35.29412)   0.00001  | 0.00001  | 0.00027  |
(0.38889, 41.17647)   0.00018  | 0.00018  | 0.00196  |
(0.38889, 47.05882)   0.00174  | 0.00174  | 0.01065  |
(0.38889, 52.94118)   0.01206  | 0.01206  | 0.04497  |
(0.38889, 58.82353)   0.06205  | 0.06205  | 0.15217  |
(0.38889, 64.70588)   0.24343  | 0.24343  | 0.41886  |
(0.38889, 70.58824)   0.74596  | 0.74596  | 0.94736  |
(0.38889, 76.47059)   1.83201  | 1.83201  | 1.78709  |
(0.38889, 82.35294)   3.70697  | 3.70697  | 2.89229  |
(0.38889, 88.23529)   6.36046  | 6.36046  | 4.19875  |
(0.38889, 94.11765)   9.51351  | 9.51351  | 5.75360  |
(0.38889, 100.00000)   12.70687  | 12.70687  | 7.72890  |
(0.38889, 105.88235)   15.44842  | 15.44842  | 10.32665  |
(0.38889, 111.76471)   17.33616  | 17.33616  | 13.72805  |
(0.38889, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.44444, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.44444, 5.88235)   0.00000  | 0.00000  | -0.00000  |
(0.44444, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(0.44444, 17.64706)   0.00000  | 0.00000  | 0.00000  |
(0.44444, 23.52941)   0.00000  | 0.00000  | 0.00000  |
(0.44444, 29.41176)   0.00000  | 0.00000  | 0.00003  |
(0.44444, 35.29412)   0.00001  | 0.00001  | 0.00030  |
(0.44444, 41.17647)   0.00018  | 0.00018  | 0.00211  |
(0.44444, 47.05882)   0.00174  | 0.00174  | 0.01106  |
(0.44444, 52.94118)   0.01206  | 0.01206  | 0.04537  |
(0.44444, 58.82353)   0.06205  | 0.06205  | 0.14966  |
(0.44444, 64.70588)   0.24343  | 0.24343  | 0.40290  |
(0.44444, 70.58824)   0.74596  | 0.74596  | 0.89481  |
(0.44444, 76.47059)   1.83201  | 1.83201  | 1.66689  |
(0.44444, 82.35294)   3.70697  | 3.70697  | 2.68477  |
(0.44444, 88.23529)   6.36046  | 6.36046  | 3.91390  |
(0.44444, 94.11765)   9.51351  | 9.51351  | 5.42778  |
(0.44444, 100.00000)   12.70687  | 12.70687  | 7.40736  |
(0.44444, 105.88235)   15.44842  | 15.44842  | 10.05554  |
(0.44444, 111.76471)   17.33616  | 17.33616  | 13.55995  |
(0.44444, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.50000, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.50000, 5.88235)   0.00000  | 0.00000  | -0.00000  |
(0.50000, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(0.50000, 17.64706)   0.00000  | 0.00000  | 0.00000  |
(0.50000, 23.52941)   0.00000  | 0.00000  | 0.00000  |
(0.50000, 29.41176)   0.00000  | 0.00000  | 0.00003  |
(0.50000, 35.29412)   0.00001  | 0.00001  | 0.00032  |
(0.50000, 41.17647)   0.00018  | 0.00018  | 0.00220  |
(0.50000, 47.05882)   0.00174  | 0.00174  | 0.01124  |
(0.50000, 52.94118)   0.01206  | 0.01206  | 0.04508  |
(0.50000, 58.82353)   0.06205  | 0.06205  | 0.14569  |
(0.50000, 64.70588)   0.24343  | 0.24343  | 0.38505  |
(0.50000, 70.58824)   0.74596  | 0.74596  | 0.84227  |
(0.50000, 76.47059)   1.83200  | 1.83200  | 1.55320  |
(0.50000, 82.35294)   3.70697  | 3.70697  | 2.49445  |
(0.50000, 88.23529)   6.36046  | 6.36046  | 3.65663  |
(0.50000, 94.11765)   9.51351  | 9.51351  | 5.13418  |
(0.50000, 100.00000)   12.70687  | 12.70687  | 7.11502  |
(0.50000, 105.88235)   15.44842  | 15.44842  | 9.80503  |
(0.50000, 111.76471)   17.33616  | 17.33616  | 13.40161  |
(0.50000, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.55556, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.55556, 5.88235)   0.00000  | 0.00000  | -0.00000  |
(0.55556, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(0.55556, 17.64706)   0.00000  | 0.00000  | 0.00000  |
(0.55556, 23.52941)   0.00000  | 0.00000  | 0.00000  |
(0.55556, 29.41176)   0.00000  | 0.00000  | 0.00004  |
(0.55556, 35.29412)   0.00001  | 0.00001  | 0.00034  |
(0.55556, 41.17647)   0.00018  | 0.00018  | 0.00225  |
(0.55556, 47.05882)   0.00174  | 0.00174  | 0.01125  |
(0.55556, 52.94118)   0.01205  | 0.01205  | 0.04429  |
(0.55556, 58.82353)   0.06204  | 0.06204  | 0.14075  |
(0.55556, 64.70588)   0.24341  | 0.24341  | 0.36627  |
(0.55556, 70.58824)   0.74593  | 0.74593  | 0.79095  |
(0.55556, 76.47059)   1.83198  | 1.83198  | 1.44672  |
(0.55556, 82.35294)   3.70696  | 3.70696  | 2.32058  |
(0.55556, 88.23529)   6.36046  | 6.36046  | 3.42437  |
(0.55556, 94.11765)   9.51351  | 9.51351  | 4.86915  |
(0.55556, 100.00000)   12.70688  | 12.70688  | 6.84848  |
(0.55556, 105.88235)   15.44842  | 15.44842  | 9.57283  |
(0.55556, 111.76471)   17.33616  | 17.33616  | 13.25207  |
(0.55556, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.61111, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.61111, 5.88235)   0.00000  | 0.00000  | -0.00000  |
(0.61111, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(0.61111, 17.64706)   0.00000  | 0.00000  | 0.00000  |
(0.61111, 23.52941)   0.00000  | 0.00000  | 0.00000  |
(0.61111, 29.41176)   0.00000  | 0.00000  | 0.00004  |
(0.61111, 35.29412)   0.00001  | 0.00001  | 0.00034  |
(0.61111, 41.17647)   0.00018  | 0.00018  | 0.00225  |
(0.61111, 47.05882)   0.00174  | 0.00174  | 0.01111  |
(0.61111, 52.94118)   0.01203  | 0.01203  | 0.04312  |
(0.61111, 58.82353)   0.06198  | 0.06198  | 0.13511  |
(0.61111, 64.70588)   0.24328  | 0.24328  | 0.34701  |
(0.61111, 70.58824)   0.74575  | 0.74575  | 0.74132  |
(0.61111, 76.47059)   1.83178  | 1.83178  | 1.34738  |
(0.61111, 82.35294)   3.70681  | 3.70681  | 2.16186  |
(0.61111, 88.23529)   6.36039  | 6.36039  | 3.21448  |
(0.61111, 94.11765)   9.51351  | 9.51351  | 4.62936  |
(0.61111, 100.00000)   12.70689  | 12.70689  | 6.60474  |
(0.61111, 105.88235)   15.44843  | 15.44843  | 9.35698  |
(0.61111, 111.76471)   17.33617  | 17.33617  | 13.11048  |
(0.61111, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.66667, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.66667, 5.88235)   -0.00000  | -0.00000  | -0.00000  |
(0.66667, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(0.66667, 17.64706)   0.00000  | 0.00000  | 0.00000  |
(0.66667, 23.52941)   0.00000  | 0.00000  | 0.00000  |
(0.66667, 29.41176)   0.00000  | 0.00000  | 0.00004  |
(0.66667, 35.29412)   0.00001  | 0.00001  | 0.00034  |
(0.66667, 41.17647)   0.00018  | 0.00018  | 0.00222  |
(0.66667, 47.05882)   0.00171  | 0.00171  | 0.01082  |
(0.66667, 52.94118)   0.01194  | 0.01194  | 0.04153  |
(0.66667, 58.82353)   0.06171  | 0.06171  | 0.12869  |
(0.66667, 64.70588)   0.24270  | 0.24270  | 0.32706  |
(0.66667, 70.58824)   0.74479  | 0.74479  | 0.69279  |
(0.66667, 76.47059)   1.83059  | 1.83059  | 1.25389  |
(0.66667, 82.35294)   3.70573  | 3.70573  | 2.01607  |
(0.66667, 88.23529)   6.35971  | 6.35971  | 3.02396  |
(0.66667, 94.11765)   9.51328  | 9.51328  | 4.41167  |
(0.66667, 100.00000)   12.70692  | 12.70692  | 6.38117  |
(0.66667, 105.88235)   15.44850  | 15.44850  | 9.15579  |
(0.66667, 111.76471)   17.33619  | 17.33619  | 12.97614  |
(0.66667, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.72222, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.72222, 5.88235)   -0.00000  | -0.00000  | -0.00000  |
(0.72222, 11.76471)   -0.00000  | -0.00000  | -0.00000  |
(0.72222, 17.64706)   0.00000  | 0.00000  | 0.00000  |
(0.72222, 23.52941)   0.00000  | 0.00000  | 0.00000  |
(0.72222, 29.41176)   0.00000  | 0.00000  | 0.00004  |
(0.72222, 35.29412)   0.00001  | 0.00001  | 0.00033  |
(0.72222, 41.17647)   0.00017  | 0.00017  | 0.00213  |
(0.72222, 47.05882)   0.00164  | 0.00164  | 0.01031  |
(0.72222, 52.94118)   0.01164  | 0.01164  | 0.03927  |
(0.72222, 58.82353)   0.06075  | 0.06075  | 0.12076  |
(0.72222, 64.70588)   0.24041  | 0.24041  | 0.30478  |
(0.72222, 70.58824)   0.74063  | 0.74063  | 0.64246  |
(0.72222, 76.47059)   1.82482  | 1.82482  | 1.16199  |
(0.72222, 82.35294)   3.69965  | 3.69965  | 1.87808  |
(0.72222, 88.23529)   6.35502  | 6.35502  | 2.84779  |
(0.72222, 94.11765)   9.51085  | 9.51085  | 4.21212  |
(0.72222, 100.00000)   12.70634  | 12.70634  | 6.17526  |
(0.72222, 105.88235)   15.44867  | 15.44867  | 8.96796  |
(0.72222, 111.76471)   17.33635  | 17.33635  | 12.84852  |
(0.72222, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.77778, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.77778, 5.88235)   -0.00000  | -0.00000  | -0.00000  |
(0.77778, 11.76471)   -0.00000  | -0.00000  | -0.00000  |
(0.77778, 17.64706)   -0.00000  | -0.00000  | 0.00000  |
(0.77778, 23.52941)   0.00000  | 0.00000  | 0.00000  |
(0.77778, 29.41176)   0.00000  | 0.00000  | 0.00003  |
(0.77778, 35.29412)   0.00001  | 0.00001  | 0.00031  |
(0.77778, 41.17647)   0.00014  | 0.00014  | 0.00195  |
(0.77778, 47.05882)   0.00148  | 0.00148  | 0.00941  |
(0.77778, 52.94118)   0.01087  | 0.01087  | 0.03574  |
(0.77778, 58.82353)   0.05803  | 0.05803  | 0.10960  |
(0.77778, 64.70588)   0.23322  | 0.23322  | 0.27622  |
(0.77778, 70.58824)   0.72612  | 0.72612  | 0.58301  |
(0.77778, 76.47059)   1.80224  | 1.80224  | 1.06074  |
(0.77778, 82.35294)   3.67250  | 3.67250  | 1.73471  |
(0.77778, 88.23529)   6.33015  | 6.33015  | 2.67343  |
(0.77778, 94.11765)   9.49433  | 9.49433  | 4.02168  |
(0.77778, 100.00000)   12.69939  | 12.69939  | 5.98253  |
(0.77778, 105.88235)   15.44768  | 15.44768  | 8.79219  |
(0.77778, 111.76471)   17.33684  | 17.33684  | 12.72750  |
(0.77778, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.83333, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.83333, 5.88235)   -0.00000  | -0.00000  | -0.00000  |
(0.83333, 11.76471)   -0.00000  | -0.00000  | -0.00000  |
(0.83333, 17.64706)   -0.00000  | -0.00000  | 0.00000  |
(0.83333, 23.52941)   -0.00000  | -0.00000  | 0.00000  |
(0.83333, 29.41176)   0.00000  | 0.00000  | 0.00003  |
(0.83333, 35.29412)   0.00001  | 0.00001  | 0.00026  |
(0.83333, 41.17647)   0.00010  | 0.00010  | 0.00165  |
(0.83333, 47.05882)   0.00118  | 0.00118  | 0.00794  |
(0.83333, 52.94118)   0.00927  | 0.00927  | 0.03017  |
(0.83333, 58.82353)   0.05182  | 0.05182  | 0.09281  |
(0.83333, 64.70588)   0.21507  | 0.21507  | 0.23534  |
(0.83333, 70.58824)   0.68556  | 0.68556  | 0.50207  |
(0.83333, 76.47059)   1.73165  | 1.73165  | 0.92926  |
(0.83333, 82.35294)   3.57604  | 3.57604  | 1.55691  |
(0.83333, 88.23529)   6.22717  | 6.22717  | 2.46819  |
(0.83333, 94.11765)   9.41095  | 9.41095  | 3.81204  |
(0.83333, 100.00000)   12.65204  | 12.65204  | 5.78607  |
(0.83333, 105.88235)   15.43241  | 15.43241  | 8.62331  |
(0.83333, 111.76471)   17.33605  | 17.33605  | 12.61326  |
(0.83333, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.88889, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.88889, 5.88235)   0.00000  | 0.00000  | -0.00000  |
(0.88889, 11.76471)   -0.00000  | -0.00000  | -0.00000  |
(0.88889, 17.64706)   -0.00000  | -0.00000  | 0.00000  |
(0.88889, 23.52941)   -0.00000  | -0.00000  | 0.00000  |
(0.88889, 29.41176)   -0.00000  | -0.00000  | 0.00002  |
(0.88889, 35.29412)   0.00000  | 0.00000  | 0.00019  |
(0.88889, 41.17647)   0.00005  | 0.00005  | 0.00121  |
(0.88889, 47.05882)   0.00076  | 0.00076  | 0.00585  |
(0.88889, 52.94118)   0.00672  | 0.00672  | 0.02233  |
(0.88889, 58.82353)   0.04070  | 0.04070  | 0.06928  |
(0.88889, 64.70588)   0.17896  | 0.17896  | 0.17816  |
(0.88889, 70.58824)   0.59574  | 0.59574  | 0.38853  |
(0.88889, 76.47059)   1.55674  | 1.55674  | 0.74266  |
(0.88889, 82.35294)   3.30518  | 3.30518  | 1.29898  |
(0.88889, 88.23529)   5.89238  | 5.89238  | 2.16373  |
(0.88889, 94.11765)   9.08649  | 9.08649  | 3.50323  |
(0.88889, 100.00000)   12.41924  | 12.41924  | 5.51881  |
(0.88889, 105.88235)   15.32501  | 15.32501  | 8.42834  |
(0.88889, 111.76471)   17.31504  | 17.31504  | 12.50139  |
(0.88889, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(0.94444, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(0.94444, 5.88235)   0.00000  | 0.00000  | -0.00000  |
(0.94444, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(0.94444, 17.64706)   -0.00000  | -0.00000  | 0.00000  |
(0.94444, 23.52941)   -0.00000  | -0.00000  | 0.00000  |
(0.94444, 29.41176)   -0.00000  | -0.00000  | 0.00001  |
(0.94444, 35.29412)   -0.00000  | -0.00000  | 0.00012  |
(0.94444, 41.17647)   0.00001  | 0.00001  | 0.00073  |
(0.94444, 47.05882)   0.00033  | 0.00033  | 0.00350  |
(0.94444, 52.94118)   0.00367  | 0.00367  | 0.01339  |
(0.94444, 58.82353)   0.02554  | 0.02554  | 0.04199  |
(0.94444, 64.70588)   0.12350  | 0.12350  | 0.11019  |
(0.94444, 70.58824)   0.44115  | 0.44115  | 0.24819  |
(0.94444, 76.47059)   1.21883  | 1.21883  | 0.49752  |
(0.94444, 82.35294)   2.71197  | 2.71197  | 0.92783  |
(0.94444, 88.23529)   5.04451  | 5.04451  | 1.66876  |
(0.94444, 94.11765)   8.10564  | 8.10564  | 2.92836  |
(0.94444, 100.00000)   11.54030  | 11.54030  | 4.96887  |
(0.94444, 105.88235)   14.78479  | 14.78479  | 8.04205  |
(0.94444, 111.76471)   17.15165  | 17.15165  | 12.33955  |
(0.94444, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(1.00000, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(1.00000, 5.88235)   -0.00000  | -0.00000  | -0.00000  |
(1.00000, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(1.00000, 17.64706)   0.00000  | 0.00000  | 0.00000  |
(1.00000, 23.52941)   -0.00000  | -0.00000  | 0.00000  |
(1.00000, 29.41176)   -0.00000  | -0.00000  | 0.00001  |
(1.00000, 35.29412)   -0.00000  | -0.00000  | 0.00005  |
(1.00000, 41.17647)   -0.00001  | -0.00001  | 0.00032  |
(1.00000, 47.05882)   0.00005  | 0.00005  | 0.00151  |
(1.00000, 52.94118)   0.00114  | 0.00114  | 0.00575  |
(1.00000, 58.82353)   0.01057  | 0.01057  | 0.01819  |
(1.00000, 64.70588)   0.06019  | 0.06019  | 0.04881  |
(1.00000, 70.58824)   0.24040  | 0.24040  | 0.11424  |
(1.00000, 76.47059)   0.72254  | 0.72254  | 0.24247  |
(1.00000, 82.35294)   1.72244  | 1.72244  | 0.48872  |
(1.00000, 88.23529)   3.41028  | 3.41028  | 0.96872  |
(1.00000, 94.11765)   5.84488  | 5.84488  | 1.90584  |
(1.00000, 100.00000)   8.97905  | 8.97905  | 3.68143  |
(1.00000, 105.88235)   12.64723  | 12.64723  | 6.83952  |
(1.00000, 111.76471)   16.20821  | 16.20821  | 11.76347  |
(1.00000, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(1.05556, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(1.05556, 5.88235)   -0.00000  | -0.00000  | -0.00000  |
(1.05556, 11.76471)   -0.00000  | -0.00000  | -0.00000  |
(1.05556, 17.64706)   0.00000  | 0.00000  | 0.00000  |
(1.05556, 23.52941)   0.00000  | 0.00000  | 0.00000  |
(1.05556, 29.41176)   0.00000  | 0.00000  | 0.00000  |
(1.05556, 35.29412)   -0.00000  | -0.00000  | 0.00001  |
(1.05556, 41.17647)   -0.00000  | -0.00000  | 0.00008  |
(1.05556, 47.05882)   -0.00002  | -0.00002  | 0.00035  |
(1.05556, 52.94118)   -0.00003  | -0.00003  | 0.00133  |
(1.05556, 58.82353)   0.00106  | 0.00106  | 0.00422  |
(1.05556, 64.70588)   0.01041  | 0.01041  | 0.01152  |
(1.05556, 70.58824)   0.05388  | 0.05388  | 0.02791  |
(1.05556, 76.47059)   0.19079  | 0.19079  | 0.06214  |
(1.05556, 82.35294)   0.51152  | 0.51152  | 0.13274  |
(1.05556, 88.23529)   1.11160  | 1.11160  | 0.28206  |
(1.05556, 94.11765)   2.07745  | 2.07745  | 0.60966  |
(1.05556, 100.00000)   3.55678  | 3.55678  | 1.36836  |
(1.05556, 105.88235)   6.05787  | 6.05787  | 3.28854  |
(1.05556, 111.76471)   11.41872  | 11.41872  | 8.73358  |
(1.05556, 117.64706)   18.12459  | 18.12459  | 18.12459  |
(1.11111, 0.00000)   0.00000  | 0.00000  | 0.00000  |
(1.11111, 5.88235)   0.00000  | 0.00000  | 0.00000  |
(1.11111, 11.76471)   0.00000  | 0.00000  | -0.00000  |
(1.11111, 17.64706)   -0.00000  | -0.00000  | -0.00000  |
(1.11111, 23.52941)   -0.00000  | -0.00000  | -0.00000  |
(1.11111, 29.41176)   -0.00000  | -0.00000  | -0.00000  |
(1.11111, 35.29412)   0.00000  | 0.00000  | -0.00000  |
(1.11111, 41.17647)   0.00000  | 0.00000  | -0.00001  |
(1.11111, 47.05882)   0.00002  | 0.00002  | -0.00002  |
(1.11111, 52.94118)   0.00003  | 0.00003  | -0.00007  |
(1.11111, 58.82353)   -0.00106  | -0.00106  | -0.00019  |
(1.11111, 64.70588)   -0.01041  | -0.01041  | -0.00050  |
(1.11111, 70.58824)   -0.05388  | -0.05388  | -0.00133  |
(1.11111, 76.47059)   -0.19079  | -0.19079  | -0.00371  |
(1.11111, 82.35294)   -0.51152  | -0.51152  | -0.01132  |
(1.11111, 88.23529)   -1.11160  | -1.11160  | -0.03753  |
(1.11111, 94.11765)   -2.07745  | -2.07745  | -0.13221  |
(1.11111, 100.00000)   -3.55678  | -3.55678  | -0.48280  |
(1.11111, 105.88235)   -6.05787  | -6.05787  | -1.79738  |
(1.11111, 111.76471)   -11.41872  | -11.41872  | -6.79448  |
(1.11111, 117.64706)   18.12459  | 18.12459  | 18.12459  |
34.59700 seconds
=================== END TEST STEPPER ===================
 */
